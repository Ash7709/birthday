<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>22-Day Love Journey ‚Äî Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    text-align: center;
    padding: 26px;
    background: linear-gradient(to bottom, #ffe6f0, #fff0f5);
    position: relative;
  }
  header {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    max-width:1000px;
    margin:0 auto 18px;
  }
  h1 { margin:0; color:#ff6b81; font-family:'Pacifico',cursive; font-size:26px; }
  .controls { display:flex; gap:10px; align-items:center; }
  .btn {
    padding:10px 14px;
    border-radius:12px;
    font-weight:600;
    text-decoration:none;
    color:white;
    background:#ff6b81;
    border:none;
    cursor:pointer;
  }
  .btn:active{ transform: translateY(1px) }
  .btn.ghost { background: #fff; color:#ff6b81; border:2px solid #ff6b81; }
  .admin-indicator { font-size:13px; color:#333; background:#fff3f6; padding:6px 10px; border-radius:10px; border:1px solid #ffd1dd; }
  #days-container { max-width:1000px; margin:18px auto; display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
  .day-btn {
    display:inline-block;
    padding:12px 18px;
    border-radius:16px;
    font-weight:700;
    color:white;
    background:#ff6b81;
    text-decoration:none;
    transition:0.18s;
    min-width:88px;
    text-align:center;
  }
  .day-btn:hover { transform:translateY(-3px); background:#ff4757; }
  .locked { background:#d8d8d8; color:#888; pointer-events:none; cursor:default; box-shadow:none; transform:none; }
  .today { box-shadow:0 0 18px 6px rgba(255,107,129,0.18); animation:glow 1.5s infinite alternate; }
  @keyframes glow { 0% { box-shadow:0 0 8px 3px rgba(255,107,129,0.12);} 100% { box-shadow:0 0 18px 8px rgba(255,107,129,0.18);} }

  .timers { display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:18px; }
  .timer-box { background:white; padding:14px 18px; border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,0.08); min-width:220px; }
  .timer-box h3 { margin:4px 0 8px; color:#ff6b81; font-size:16px; }
  .time { font-size:22px; color:#ff6b81; font-weight:700; }

  /* modal */
  .modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.45); display:flex; align-items:center; justify-content:center; z-index:9999; }
  .modal { background:white; padding:18px; border-radius:12px; width:320px; box-shadow:0 12px 40px rgba(0,0,0,0.25); }
  .modal h4 { margin:0 0 10px; color:#ff6b81; }
  .modal input { width:100%; padding:10px 12px; margin-bottom:10px; border-radius:8px; border:1px solid #e0e0e0; }
  .modal .row { display:flex; gap:8px; justify-content:flex-end; }

  /* small screens */
  @media (max-width:420px){ .day-btn{ min-width:70px; padding:10px 12px; } .timer-box{ min-width:160px; } header{flex-direction:column; gap:8px; align-items:flex-start} }
</style>
</head>
<body>

<header>
  <h1>üéÅ 22-Day Love Journey</h1>
  <div class="controls">
    <div id="adminBadge" style="display:none;" class="admin-indicator">Admin mode</div>
    <button id="adminBtn" class="btn">Admin</button>
    <button id="logoutBtn" class="btn ghost" style="display:none;">Log out</button>
  </div>
</header>

<p style="color:#ff6b81; margin-top:0;">All days are visible. Only today's or previous days are clickable. Future days remain locked.</p>

<div id="days-container" aria-live="polite"></div>

<div class="timers" style="margin-top:18px;">
  <div class="timer-box">
    <h3>Next Surprise</h3>
    <div class="time" id="surpriseTimer">--</div>
  </div>
  <div class="timer-box">
    <h3>Birthday (Nov 5)</h3>
    <div class="time" id="birthdayTimer">--</div>
  </div>
</div>

<!-- Admin modal (hidden by default) -->
<div id="modalRoot" style="display:none;"></div>

<script>
/* ================== CONFIG ==================
   Change the adminPassword to something private.
   This is client-side only (for testing), so keep real secrets off this page.
*/
const adminPassword = 'test123'; // <<< change this to your private password

/* timeline config */
const startDate = new Date('2025-10-14'); // Day 1 date
const totalDays = 22;
const birthdayDate = new Date('2025-11-05');

/* NOTE: We use the visitor's local timezone (device time). If you need to force IST, we can adjust. */

/* ================ UTILS ================ */
function daysBetween(a,b){
  return Math.floor((b - a) / (1000*60*60*24));
}

/* ================ STATE ================ */
const today = new Date();
let currentDay = daysBetween(startDate, today) + 1;
if(currentDay < 1) currentDay = 1;
if(currentDay > totalDays) currentDay = totalDays;

/* admin session stored in sessionStorage key 'lj_admin' */
function isAdmin() { return sessionStorage.getItem('lj_admin') === '1'; }
function setAdmin(flag){ sessionStorage.setItem('lj_admin', flag ? '1' : '0'); }

/* ================ RENDER DAYS ================ */
const container = document.getElementById('days-container');

function renderDays(){
  container.innerHTML = '';
  const admin = isAdmin();

  for(let i=1;i<=totalDays;i++){
    const a = document.createElement('a');
    a.className = 'day-btn';
    a.textContent = 'Day ' + i;
    // allow click if day <= currentDay OR admin mode
    if(i <= currentDay || admin){
      a.href = 'day' + i + '.html';
      if(i === currentDay) a.classList.add('today');
    } else {
      a.classList.add('locked');
      // show tooltip-ish title with unlock date
      const unlockDate = new Date(startDate);
      unlockDate.setDate(startDate.getDate() + (i-1));
      const s = unlockDate.toLocaleDateString();
      a.title = 'Unlocks on ' + s + ' at 12:00 AM';
    }
    container.appendChild(a);
  }

  // admin badge & logout visibility
  document.getElementById('adminBadge').style.display = admin ? 'inline-block' : 'none';
  document.getElementById('logoutBtn').style.display = admin ? 'inline-block' : 'none';
  document.getElementById('adminBtn').style.display = admin ? 'none' : 'inline-block';
}

/* ================ TIMERS ================ */
function getNextSurpriseMidnight(){
  if(currentDay < totalDays){
    const d = new Date(startDate);
    d.setDate(startDate.getDate() + currentDay); // next day's date (day index = currentDay+1)
    d.setHours(0,0,0,0);
    return d;
  } else {
    const d = new Date(birthdayDate);
    d.setHours(0,0,0,0);
    return d;
  }
}

function formatCountdown(ms){
  if(ms <= 0) return '0d 0h 0m 0s';
  const d = Math.floor(ms / (1000*60*60*24));
  const h = Math.floor((ms % (1000*60*60*24)) / (1000*60*60));
  const m = Math.floor((ms % (1000*60*60)) / (1000*60));
  const s = Math.floor((ms % (1000*60)) / 1000);
  return `${d}d ${h}h ${m}m ${s}s`;
}

function updateTimers(){
  const now = new Date();
  const next = getNextSurpriseMidnight();
  document.getElementById('surpriseTimer').textContent = formatCountdown(next - now);

  const bd = new Date(birthdayDate); bd.setHours(0,0,0,0);
  document.getElementById('birthdayTimer').textContent = formatCountdown(bd - now);

  // if reached or passed next surprise, recalc currentDay and re-render (so UI auto-updates around midnight)
  if(now >= next){
    // recompute currentDay fresh
    const t = new Date();
    currentDay = daysBetween(startDate, t) + 1;
    if(currentDay < 1) currentDay = 1;
    if(currentDay > totalDays) currentDay = totalDays;
    renderDays();
  }
}

/* ================ ADMIN FLOW ================ */
const modalRoot = document.getElementById('modalRoot');

function openAdminModal(){
  modalRoot.innerHTML = `
    <div class="modal-backdrop" id="modalBackdrop">
      <div class="modal" role="dialog" aria-modal="true">
        <h4>Admin Access</h4>
        <p style="margin:6px 0 12px; color:#333;">Enter password to unlock all days for testing.</p>
        <input id="adminPass" type="password" placeholder="Password" />
        <div style="display:flex; gap:8px; justify-content:flex-end;">
          <button id="cancelBtn" class="btn ghost">Cancel</button>
          <button id="submitBtn" class="btn">Unlock</button>
        </div>
      </div>
    </div>
  `;
  modalRoot.style.display = 'block';
  document.getElementById('adminPass').focus();

  document.getElementById('cancelBtn').onclick = closeModal;
  document.getElementById('submitBtn').onclick = tryAdmin;
  document.getElementById('modalBackdrop').addEventListener('click', function(e){
    if(e.target.id === 'modalBackdrop') closeModal();
  });
  document.getElementById('adminPass').addEventListener('keydown', function(e){
    if(e.key === 'Enter') tryAdmin();
  });
}

function closeModal(){
  modalRoot.style.display = 'none';
  modalRoot.innerHTML = '';
}

function tryAdmin(){
  const val = document.getElementById('adminPass').value || '';
  if(val === adminPassword){
    setAdmin(true);
    closeModal();
    renderDays();
    alert('Admin unlocked ‚Äî all days are clickable for testing.');
  } else {
    // small shake feedback (simple)
    const inp = document.getElementById('adminPass');
    inp.style.borderColor = '#ff6b81';
    setTimeout(()=> inp.style.borderColor = '', 900);
    inp.value = '';
    inp.focus();
  }
}

document.getElementById('adminBtn').addEventListener('click', openAdminModal);
document.getElementById('logoutBtn').addEventListener('click', function(){
  setAdmin(false);
  renderDays();
});

/* ================ INIT ================ */
renderDays();
updateTimers();
setInterval(updateTimers, 1000);

/* Optional: if you want admin mode to persist across tabs, change sessionStorage -> localStorage
   but sessionStorage is safer for temporary testing and clears on tab close. */
</script>

</body>
</html>
